{"version":3,"sources":["xhr_loader.js","gapi_config.js","App.js","index.js"],"names":["xhr_load_script","url","callback","method","is_async","includes","toUpperCase","Error","xhr","XMLHttpRequest","onreadystatechange","readyState","DONE","status","script","document","createElement","innerHTML","responseText","querySelector","appendChild","setTimeout","open","send","credentials","apiKey","clientId","discoveryDocs","scopes","GapiWrapper","this","gapi","init_gapi_callback","instance","spreadsheet_id","invalid_spreadsheet_id","is_ready","auth2","getAuthInstance","signIn","signOut","title","window","isSignedIn","get","this_gapi_wrapper","client","drive","files","list","then","response","result","length","file","i","id","error_msg","console","log","alert","sheets","spreadsheets","create","properties","spreadsheetId","create_spreadsheet","App","props","update_sign_in_status","setState","logged_in","render","className","style","state","display","onClick","gapi_oauth","gapi_logout","doc_obtained","gapi_open_spreadsheet","gapi_unload_spreadsheet","scope","passwords","map","value","index","key","update_url","update_uname","uname","gapi_pwd_to_clipboard","gapi_update_pwd","gapi_wrapper","sign_in","e","sign_out","update_doc_obtained_status","get_spreadsheet","spreadsheet_name","update_url_in_state","new_url","pwd","prompt","update_uname_in_state","new_uname","encrypted_pwd","signed_in_hook","toString","call","init","listen","error","JSON","stringify","load","create_gapi_wrapper","React","Component","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.52e0ce46.chunk.js","sourcesContent":["function xhr_load_script(url, callback, method=\"GET\", is_async=true) {\n    if ( ! [\"GET\", \"POST\", \"HEAD\"].includes(method.toUpperCase()) ) {\n        throw new Error(\"Unhandled method passed\");\n    }\n\n    var xhr = new XMLHttpRequest();\n    xhr.onreadystatechange = function() {\n        if (xhr.readyState === XMLHttpRequest.DONE) {\n            if (xhr.status === 200) {\n                var script = document.createElement(\"script\");\n                script.innerHTML = xhr.responseText;\n                document.querySelector(\"head\").appendChild(script);\n            }\n            if (typeof callback != \"undefined\") {\n                setTimeout(function(){callback(xhr.responseText, xhr.status, xhr)}, 0);\n            }\n        }\n    };\n\n    xhr.open(method, url, is_async);\n    xhr.send();\n}\n\nexport default xhr_load_script;\n","import xhr_load_script from \"./xhr_loader\";\n\n/* scopes: https://developers.google.com/sheets/api/guides/authorizing\n * Multiple scopes are allowed, separate them with spaces\n */\nvar credentials = {\n    apiKey: \"AIzaSyA3k2KGpFCPZolfzG0dZxIMQSNEBTK2Q0s\",\n    clientId: \"693421068041-8v4j719d0cg5dek8ab2elmen2mqe33b8.apps.googleusercontent.com\",\n    discoveryDocs: [\"https://sheets.googleapis.com/$discovery/rest?version=v4\",\n        \"https://www.googleapis.com/discovery/v1/apis/drive/v3/rest\"],\n    scopes: \"https://www.googleapis.com/auth/drive.metadata.readonly https://www.googleapis.com/auth/spreadsheets\"\n};\n\n/* interface class abstracting away gapi from the app\n * https://developers.google.com/sheets/api/\n */\nclass GapiWrapper {\n    constructor() {\n        this.gapi = null;\n        this.init_gapi_callback = function() {};\n        this.instance = null;\n        this.spreadsheet_id = null;\n        this.invalid_spreadsheet_id = -1;\n    }\n\n    is_ready() {\n        if ( this.gapi == null )\n            return false;\n        return true;\n    }\n\n    get_gapi_callback() {\n        return this.init_gapi_callback;\n    }\n\n    sign_in() {\n        if ( ! this.is_ready() ) {\n            throw new Error(\"Gooogle API is still loading, please try again\");\n        }\n        this.gapi.auth2.getAuthInstance().signIn();\n    }\n\n    sign_out() {\n        if ( ! this.is_ready() ) {\n            throw new Error(\"Gooogle API is still loading, please try again\");\n        }\n        this.gapi.auth2.getAuthInstance().signOut();\n    }\n\n    // TODO: refactor\n    get_spreadsheet(title, callback) {\n        if ( ! this.is_ready() ) {\n            throw new Error(\"Gooogle API is still loading, please try again\");\n        }\n        if ( ! window.gapi.auth2.getAuthInstance().isSignedIn.get() ) {\n            throw new Error(\"You need to be signed in to create documents\");\n        }\n        if ( this.spreadsheet_id != null ) {\n            throw new Error(\"Your request is being processed or document has already been created\");\n        }\n\n        // User may quickly click multiple times\n        // We need to ensure above condition won't let us in next time\n        // That's why we set magic number below\n        this.spreadsheet_id = this.invalid_spreadsheet_id;\n\n        var this_gapi_wrapper = this.instance;\n\n        var create_spreadsheet = function(title, callback) {\n            this_gapi_wrapper.gapi.client.sheets.spreadsheets.create({\n                properties: {title: title}\n            }).then((response) => {\n                this_gapi_wrapper.spreadsheet_id = response.result.spreadsheetId;\n                callback(true);\n            });\n        }\n\n        // Check if file already exists\n        // https://developers.google.com/drive/api/v3/search-files\n        this.gapi.client.drive.files.list({\n            'pageSize': 10,\n            'q': \"mimeType='application/vnd.google-apps.spreadsheet' and name='\" + title + \"'\",\n            'fields': \"nextPageToken, files(id, name)\"\n        }).then(function(response) {\n            var files = response.result.files;\n            if ( files && files.length == 1 ) {\n                var file = null;\n                for (var i = 0; i < files.length; i++) {\n                    file = files[i];\n                    this_gapi_wrapper.spreadsheet_id = file.id;\n                    callback(true);\n                }\n            } else if ( files.length > 1 ) {\n                // This is critical situation, user should not proceed\n                this_gapi_wrapper.spreadsheet_id = this_gapi_wrapper.invalid_spreadsheet_id;\n\n                var error_msg = \"More than one '\" + title + \"' found. Remove unwanted copy and try again\";\n                error_msg += \"\\nIf you removed duplicate remember to also remove it from google drive trash\";\n                console.log(error_msg);\n                alert(error_msg);\n                throw new Error(error_msg);\n            } else {\n                create_spreadsheet(title, callback);\n            }\n        });\n    }\n}\n\n/* Cannot use GapiWrapper constructor because we need to pass instance of it to async callback */\nexport default function create_gapi_wrapper(signed_in_hook) {\n    // signed_in_hook must be a function\n    if ( ! signed_in_hook && {}.toString.call(signed_in_hook) === '[object Function]' )\n        throw new Error(\"signed_in_hook must be a function.\");\n\n    var gapi_wrapper = new GapiWrapper();\n    gapi_wrapper.instance = gapi_wrapper;\n    gapi_wrapper.init_gapi_callback = function() {\n        window.gapi.client.init({\n            apiKey: credentials.apiKey,\n            clientId: credentials.clientId,\n            discoveryDocs: credentials.discoveryDocs,\n            scope: credentials.scopes\n        }).then(function () {\n            // Listen for sign-in state changes.\n            window.gapi.auth2.getAuthInstance().isSignedIn.listen(signed_in_hook);\n\n            // Handle the initial sign-in state.\n            signed_in_hook(window.gapi.auth2.getAuthInstance().isSignedIn.get());\n            // Pass gapi object to the wrapper for later use\n            gapi_wrapper.gapi = window.gapi;\n        }, function(error) {\n            console.log(JSON.stringify(error, null, 2));\n        });\n    }\n\n    xhr_load_script(\"https://apis.google.com/js/api.js\", function(){\n        window.gapi.load('client:auth2', gapi_wrapper.init_gapi_callback)\n    });\n\n    return gapi_wrapper;\n}\n","import React from \"react\";\nimport create_gapi_wrapper from \"./gapi_config\";\n\nclass App extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            logged_in: false,\n            doc_obtained: false,\n            passwords: [\n                {url: \"example.com\", uname: \"example\", encrypted_pwd: \"\"},\n                {url: \"example.com\", uname: \"example\", encrypted_pwd: \"\"},\n                {url: \"example.com\", uname: \"example\", encrypted_pwd: \"\"},\n                {url: \"example.com\", uname: \"example\", encrypted_pwd: \"\"}]\n        }\n        this.spreadsheet_name = \"do_not_rename_me_aes_256_passwords.xls\";\n        this.gapi_wrapper = create_gapi_wrapper(this.update_sign_in_status);\n    }\n    update_sign_in_status = (status) => {\n        this.setState({\n            logged_in: status\n        });\n    }\n    render = () => {\n        return (\n            <div>\n                <h4 className=\"bg-primary text-white text-center p-2\">\n                    Passwords\n                </h4>\n                <button className=\"btn btn-primary m-2\"\n                        style={ this.state.logged_in ? {display: \"none\"} : {display: \"block\"} }\n                        onClick={ this.gapi_oauth }>\n                    Authenticate to your google account\n                </button>\n                <button className=\"btn btn-primary m-2\"\n                        style={ this.state.logged_in ? {display: \"block\"} : {display: \"none\"} }\n                        onClick={ this.gapi_logout }>\n                    Log out from your google account\n                </button>\n                <button className=\"btn btn-primary m-2\"\n                        style={ this.state.logged_in && ! this.state.doc_obtained ? {display: \"block\"} : {display: \"none\"} }\n                        onClick={ this.gapi_open_spreadsheet }>\n                    Open spreadsheet\n                </button>\n                <button className=\"btn btn-primary m-2\"\n                        style={ this.state.logged_in && this.state.doc_obtained ? {display: \"block\"} : {display: \"none\"} }\n                        onClick={ this.gapi_unload_spreadsheet }>\n                    Unload spreadsheet\n                </button>\n                <table className=\"table\"\n                        style={ this.state.logged_in && this.state.doc_obtained ? {display: \"block\"} : {display: \"none\"} } >\n                    <thead className=\"thead-dark\">\n                        <tr>\n                            <th scope=\"col\">#</th>\n                            <th scope=\"col\">url</th>\n                            <th scope=\"col\">user name</th>\n                            <th scope=\"col\">password</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                    {this.state.passwords.map((value, index) => {\n                        return <tr key={index}>\n                            <td>{index}</td>\n                            <td onClick={ () => this.update_url(index) }>{value.url}</td>\n                            <td onClick={ () => this.update_uname(index) }>{value.uname}</td>\n                            <td onClick={ () => this.gapi_pwd_to_clipboard(index) }>***</td>\n                            <td onClick={ () => this.gapi_update_pwd(index) }>change password</td>\n                        </tr>\n                    })}\n                    </tbody>\n                </table>\n            </div>\n        )\n    }\n    gapi_oauth = () => {\n        try {\n            this.gapi_wrapper.sign_in();\n        } catch (e) {\n            alert(e);\n        }\n    }\n    gapi_logout = () => {\n        try {\n            this.gapi_wrapper.sign_out();\n        } catch (e) {\n            alert(e);\n        }\n    }\n\n    update_doc_obtained_status = (status) => {\n        this.setState({\n            doc_obtained: status\n        });\n    }\n    gapi_open_spreadsheet = () => {\n        try {\n            this.gapi_wrapper.get_spreadsheet(this.spreadsheet_name, this.update_doc_obtained_status);\n        } catch (e) {\n            alert(e);\n        }\n    }\n\n    gapi_unload_spreadsheet = () => {\n        this.setState({\n            passwords: [],\n            doc_obtained: false\n        });\n        this.gapi_wrapper.spreadsheet_id = null;\n    }\n\n    update_url_in_state = (index, new_url) => {\n        // https://stackoverflow.com/questions/29537299\n        let passwords = [...this.state.passwords];\n        let pwd = {...passwords[index]};\n        pwd.url = new_url;\n        passwords[index] = pwd;\n        this.setState({\n            passwords: passwords\n        });\n    }\n    update_url = (index) => {\n        var new_url = prompt(this.state.passwords[index].url);\n        this.update_url_in_state(index, new_url);\n    }\n\n    update_uname_in_state = (index, new_uname) => {\n        let passwords = [...this.state.passwords];\n        let pwd = {...passwords[index]};\n        pwd.uname = new_uname;\n        passwords[index] = pwd;\n        this.setState({\n            passwords: passwords\n        });\n    }\n    update_uname = (index) => {\n        var new_uname = prompt(this.state.passwords[index].uname);\n        this.update_uname_in_state(index, new_uname);\n    }\n\n    gapi_pwd_to_clipboard = (index) => {\n    }\n    gapi_update_pwd = (index) => {\n    }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport 'bootstrap/dist/css/bootstrap.css';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}