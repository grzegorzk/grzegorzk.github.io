{"version":3,"sources":["xhr_loader.js","gapi_config.js","App.js","index.js"],"names":["xhr_load_script","url","callback","method","is_async","includes","toUpperCase","Error","xhr","XMLHttpRequest","onreadystatechange","readyState","DONE","status","script","document","createElement","innerHTML","responseText","querySelector","appendChild","setTimeout","open","send","credentials","apiKey","clientId","discoveryDocs","scopes","GapiWrapper","this","gapi","init_gapi_callback","instance","spreadsheet_id","is_ready","auth2","getAuthInstance","signIn","signOut","title","window","isSignedIn","get","this_gapi_wrapper","client","drive","files","list","then","response","result","length","i","file","id","sheets","spreadsheets","create","properties","spreadsheetId","App","props","update_sign_in_status","setState","logged_in","render","className","style","state","display","onClick","gapi_oauth","gapi_logout","doc_created","gapi_create_spreadsheet","gapi_wrapper","sign_in","e","alert","sign_out","update_doc_created_status","create_spreadsheet","passwords","encrypted_pwd","signed_in_hook","toString","call","init","scope","listen","error","console","log","JSON","stringify","load","create_gapi_wrapper","React","Component","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.cb61ba21.chunk.js","sourcesContent":["function xhr_load_script(url, callback, method=\"GET\", is_async=true) {\n    if ( ! [\"GET\", \"POST\", \"HEAD\"].includes(method.toUpperCase()) ) {\n        throw new Error(\"Unhandled method passed\");\n    }\n\n    var xhr = new XMLHttpRequest();\n    xhr.onreadystatechange = function() {\n        if (xhr.readyState === XMLHttpRequest.DONE) {\n            if (xhr.status === 200) {\n                var script = document.createElement(\"script\");\n                script.innerHTML = xhr.responseText;\n                document.querySelector(\"head\").appendChild(script);\n            }\n            if (typeof callback != \"undefined\") {\n                setTimeout(function(){callback(xhr.responseText, xhr.status, xhr)}, 0);\n            }\n        }\n    };\n\n    xhr.open(method, url, is_async);\n    xhr.send();\n}\n\nexport default xhr_load_script;\n","import xhr_load_script from \"./xhr_loader\";\n\n/* scopes: https://developers.google.com/sheets/api/guides/authorizing\n * Multiple scopes are allowed, separate them with spaces\n */\nvar credentials = {\n    apiKey: \"AIzaSyA3k2KGpFCPZolfzG0dZxIMQSNEBTK2Q0s\",\n    clientId: \"693421068041-8v4j719d0cg5dek8ab2elmen2mqe33b8.apps.googleusercontent.com\",\n    discoveryDocs: [\"https://sheets.googleapis.com/$discovery/rest?version=v4\",\n        \"https://www.googleapis.com/discovery/v1/apis/drive/v3/rest\"],\n    scopes: \"https://www.googleapis.com/auth/drive.metadata.readonly https://www.googleapis.com/auth/spreadsheets\"\n};\n\n/* interface class abstracting away gapi from the app\n * https://developers.google.com/sheets/api/\n */\nclass GapiWrapper {\n    constructor() {\n        this.gapi = null;\n        this.init_gapi_callback = function() {};\n        this.instance = null;\n        this.spreadsheet_id = null;\n    }\n\n    is_ready() {\n        if ( this.gapi == null )\n            return false;\n        return true;\n    }\n\n    get_gapi_callback() {\n        return this.init_gapi_callback;\n    }\n\n    sign_in() {\n        if ( ! this.is_ready() ) {\n            throw new Error(\"Gooogle API is still loading, please try again\");\n        }\n        this.gapi.auth2.getAuthInstance().signIn();\n    }\n\n    sign_out() {\n        if ( ! this.is_ready() ) {\n            throw new Error(\"Gooogle API is still loading, please try again\");\n        }\n        this.gapi.auth2.getAuthInstance().signOut();\n    }\n\n    // TODO: refactor\n    create_spreadsheet(title, callback) {\n        if ( ! this.is_ready() ) {\n            throw new Error(\"Gooogle API is still loading, please try again\");\n        }\n        if ( ! window.gapi.auth2.getAuthInstance().isSignedIn.get() ) {\n            throw new Error(\"You need to be signed in to create documents\");\n        }\n        if ( this.spreadsheet_id != null ) {\n            throw new Error(\"Your request is being processed or document has already been created\");\n        }\n\n        // User may quickly click multiple times\n        // We need to ensure above condition won't let us in next time\n        this.spreadsheet_id = -1;\n\n        var this_gapi_wrapper = this.instance;\n\n        // Check if file already exists\n        // https://developers.google.com/drive/api/v3/search-files\n        this.gapi.client.drive.files.list({\n            'pageSize': 10,\n            'q': \"mimeType='application/vnd.google-apps.spreadsheet' and name='\" + title + \"'\",\n            'fields': \"nextPageToken, files(id, name)\"\n        }).then(function(response) {\n            var files = response.result.files;\n            if ( files && files.length > 0 ) {\n                for (var i = 0; i < files.length; i++) {\n                    var file = files[i];\n                    this_gapi_wrapper.spreadsheet_id = file.id;\n                    callback(true);\n                    // TODO: more files could match search criteria\n                    break;\n                }\n            } else {\n                this_gapi_wrapper.gapi.client.sheets.spreadsheets.create({\n                    properties: {title: title}\n                }).then((response) => {\n                    this_gapi_wrapper.spreadsheet_id = response.result.spreadsheetId;\n                    callback(true);\n                });\n            }\n        });\n    }\n}\n\n/* Cannot use GapiWrapper constructor because we need to pass instance of it to async callback */\nexport default function create_gapi_wrapper(signed_in_hook) {\n    // signed_in_hook must be a function\n    if ( ! signed_in_hook && {}.toString.call(signed_in_hook) === '[object Function]' )\n        throw new Error(\"signed_in_hook must be a function.\");\n\n    var gapi_wrapper = new GapiWrapper();\n    gapi_wrapper.instance = gapi_wrapper;\n    gapi_wrapper.init_gapi_callback = function() {\n        window.gapi.client.init({\n            apiKey: credentials.apiKey,\n            clientId: credentials.clientId,\n            discoveryDocs: credentials.discoveryDocs,\n            scope: credentials.scopes\n        }).then(function () {\n            // Listen for sign-in state changes.\n            window.gapi.auth2.getAuthInstance().isSignedIn.listen(signed_in_hook);\n\n            // Handle the initial sign-in state.\n            signed_in_hook(window.gapi.auth2.getAuthInstance().isSignedIn.get());\n            // Pass gapi object to the wrapper for later use\n            gapi_wrapper.gapi = window.gapi;\n        }, function(error) {\n            console.log(JSON.stringify(error, null, 2));\n        });\n    }\n\n    xhr_load_script(\"https://apis.google.com/js/api.js\", function(){\n        window.gapi.load('client:auth2', gapi_wrapper.init_gapi_callback)\n    });\n\n    return gapi_wrapper;\n}\n","import React from \"react\";\nimport create_gapi_wrapper from \"./gapi_config\";\n\nclass App extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            logged_in: false,\n            doc_created: false,\n            passwords: [{url: \"example.com\", encrypted_pwd: \"\"},\n                {url: \"example.com\", encrypted_pwd: \"\"},\n                {url: \"example.com\", encrypted_pwd: \"\"},\n                {url: \"example.com\", encrypted_pwd: \"\"}]\n        }\n\n        this.gapi_wrapper = create_gapi_wrapper(this.update_sign_in_status);\n    }\n    update_sign_in_status = (status) => {\n        this.setState({\n            logged_in: status\n        });\n    }\n    render = () => {\n        return (\n            <div>\n                <h4 className=\"bg-primary text-white text-center p-2\">\n                    Passwords\n                </h4>\n                <button className=\"btn btn-primary m-2\"\n                        style={ this.state.logged_in ? {display: \"none\"} : {display: \"block\"} }\n                        onClick={ this.gapi_oauth }>\n                    Authenticate to your google account\n                </button>\n                <button className=\"btn btn-primary m-2\"\n                        style={ this.state.logged_in ? {display: \"block\"} : {display: \"none\"} }\n                        onClick={ this.gapi_logout }>\n                    Log out from your google account\n                </button>\n                <button className=\"btn btn-primary m-2\"\n                        style={ this.state.logged_in && ! this.state.doc_created ? {display: \"block\"} : {display: \"none\"} }\n                        onClick={ this.gapi_create_spreadsheet }>\n                    Create spreadsheet\n                </button>\n            </div>\n        )\n    }\n    gapi_oauth = () => {\n        try {\n            this.gapi_wrapper.sign_in();\n        } catch (e) {\n            alert(e);\n        }\n    }\n    gapi_logout = () => {\n        try {\n            this.gapi_wrapper.sign_out();\n        } catch (e) {\n            alert(e);\n        }\n    }\n\n    update_doc_created_status = (status) => {\n        this.setState({\n            doc_created: status\n        });\n    }\n    gapi_create_spreadsheet = () => {\n        try {\n            this.gapi_wrapper.create_spreadsheet(\"do_not_rename_me_aes_256_passwords.xls\", this.update_doc_created_status);\n        } catch (e) {\n            alert(e);\n        }\n    }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport 'bootstrap/dist/css/bootstrap.css';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}